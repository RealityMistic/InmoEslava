@model InmoEslava.ViewModel.PropertyViewModel

<div class="container py-5">
    <div class="row g-4">
        <div class="col-md-3">
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Price</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">$@Model.Property.Price</li>

                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Region</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">@Model.Property.Region</li>

                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Province</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">@Model.Property.Province</li>

                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Municipality</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">@Model.Property.Municipality</li>

                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Rooms</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.Rooms)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">Studio / 1 room</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">2 Rooms</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">3 Rooms</li>
                        }
                        else if (Convert.ToInt32(item) == 4)
                        {
                            <li class="list-group-item">4 Rooms or more</li>
                        }
                    }


                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Toilets</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.Toilet)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">One</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">Two</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">Three or more</li>
                        }
                    }
                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Location</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.Location)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">On the Beach</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">In the City Center</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">In the Country Side</li>
                        }
                        else if (Convert.ToInt32(item) == 4)
                        {
                            <li class="list-group-item">Small Town</li>
                        }
                        else if (Convert.ToInt32(item) == 5)
                        {
                            <li class="list-group-item">Mountain</li>
                        }
                    }
                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Near To</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.NearTo)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">Beach</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">Mall</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">Nice Street</li>
                        }
                        else if (Convert.ToInt32(item) == 4)
                        {
                            <li class="list-group-item">Bus</li>
                        }
                        else if (Convert.ToInt32(item) == 5)
                        {
                            <li class="list-group-item">Train</li>
                        }
                    }
                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Materials</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.Material)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">Brick</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">Stone</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">Concrete</li>
                        }
                        else if (Convert.ToInt32(item) == 4)
                        {
                            <li class="list-group-item">Wood</li>
                        }
                        else if (Convert.ToInt32(item) == 5)
                        {
                            <li class="list-group-item">Quality</li>
                        }
                    }

                </ul>
            </div>
            <div class="card mb-2 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal  h6 text-uppercase">Characteristics</h4>
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var item in Model.Characterstic)
                    {
                        if (Convert.ToInt32(item) == 1)
                        {
                            <li class="list-group-item">Garage</li>
                        }
                        else if (Convert.ToInt32(item) == 2)
                        {
                            <li class="list-group-item">Chimney</li>
                        }
                        else if (Convert.ToInt32(item) == 3)
                        {
                            <li class="list-group-item">Garden</li>
                        }
                        else if (Convert.ToInt32(item) == 4)
                        {
                            <li class="list-group-item">Swimming pool</li>
                        }
                        else if (Convert.ToInt32(item) == 5)
                        {
                            <li class="list-group-item">Air Conditioning</li>
                        }
                        else if (Convert.ToInt32(item) == 6)
                        {
                            <li class="list-group-item">Built-in Closets</li>
                        }
                    }
                </ul>
            </div>
        </div>
        <div class="col-md-6">
            <a class="btn btn-outline-primary" href="/?refer=detailpage">Back to results</a>

            <div class="d-flex align-items-center">
                <h1 class="display-6 mt-2 flex-grow-1">@Model.Property.Name</h1>
                <button type="button" class="hide-is-user-not-logged-in favorite-btn favoritePropertyToggle fa-star"></button>

            </div>



            <div id="carouselExampleControls" class="my-4 carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    @if (Model.Images != null && Model.Images.Length > 0)
                    {
                        foreach (var item in Model.Images)
                        {
                            <div class="carousel-item">
                                <img src=@item class="d-block w-100">
                            </div>
                        }
                    }
                    <div class="carousel-item active">
                        <img src="https://picsum.photos/seed/picsum/1280/768" class="d-block w-100">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <p class="lead">@Model.Property.Description Quickly build an effective pricing table for your potential customers with this Bootstrap example. It’s built with default Bootstrap components and utilities with little customization.</p>
        </div>
        <div class="col-md-3">
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-warning">
                    <h4 class="my-0 font-weight-normal h5">RS Agent</h4>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Telephone Number:</strong> 999999999</li>
                    <li class="list-group-item"><strong>E-mail:</strong> test@gmail.com</li>
                    <li class="list-group-item"><strong>Working Time:</strong> 9:00 to 18:00</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">

    </div>
</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        $(document).ready(function () {

            var isPropFavorite = false;
            const urlParams = new URLSearchParams(window.location.search);
            const myParam = urlParams.get('Id');
            console.log(isPropFavorite)
            $.ajax({
                url: 'https://localhost:44335/api/Property/GetFavouriteStatus/' + myParam,
                type: 'GET',
                success: function (response) {
                    console.log(response);
                    isPropFavorite = response;
                    if (isPropFavorite) {
                        $('.favoritePropertyToggle').addClass('fas')
                    } else {
                        $('.favoritePropertyToggle').addClass('far')
                    }
                },
                error: function (error) {
                    alert('Error marking Favourite');
                }
            });
        });
            

            
        $('.favoritePropertyToggle').on('çlick', function (e) {

            console.log("clicked");
            $.ajax({
                url: 'https://localhost:44335/api/Property/SetFavouriteStatus/' + myParam + '/' + !isPropFavorite,
                type: 'POST',
                success: function (response) {
                    alert('Property added to Database Successfully');

                    $('.favoritePropertyToggle').removeClass('far fas')


                    if (isPropFavorite) {
                        $('.favoritePropertyToggle').addClass('fas')
                    } else {
                        $('.favoritePropertyToggle').addClass('far')
                    }
                },
                error: function (error) {
                    alert('Error marking Favourite');
                }
            });
        });
                
    </script>}